!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("easy-template-x",[],t):"object"==typeof exports?exports["easy-template-x"]=t():e["easy-template-x"]=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return r});var r=new(function(){function t(){this._isNode=null}return Object.defineProperty(t.prototype,"isNode",{get:function(){if(null===this._isNode){var t=void 0!==e&&void 0!==e.release&&"node"===e.release.name,n="undefined"!=typeof window;this._isNode=t||!n}return this._isNode},enumerable:!0,configurable:!0}),t}())}).call(this,n(5))},function(e,t){e.exports=require("jszip")},function(e,t,n){"use strict";n.r(t);var r,o,i=function(){return function(e){Object.assign(this,e)}}(),a=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(n){var r=e.call(this,"XML maximum depth reached (max depth: "+n+").")||this;return r.maxDepth=n,Object.setPrototypeOf(r,t.prototype),r}return a(t,e),t}(Error),u=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(e){function t(n){var r=e.call(this,"Argument '"+n+"' is missing.")||this;return Object.setPrototypeOf(r,t.prototype),r}return u(t,e),t}(Error),l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(e){function t(n){var r=e.call(this,"Tag '"+n+"' does not have a closing delimiter.")||this;return r.tagName=n,Object.setPrototypeOf(r,t.prototype),r}return l(t,e),t}(Error),f=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(e){function t(n){var r=e.call(this,"Tag '"+n+"' does not have an opening delimiter.")||this;return r.tagName=n,Object.setPrototypeOf(r,t.prototype),r}return f(t,e),t}(Error),h=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(e){function t(n){var r=e.call(this,"Tag '"+n+"' is never closed.")||this;return r.tagName=n,Object.setPrototypeOf(r,t.prototype),r}return h(t,e),t}(Error),x=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(e){function t(){var n=e.call(this,"The filetype for this file could not be identified, is this file corrupted?")||this;return Object.setPrototypeOf(n,t.prototype),n}return x(t,e),t}(Error),g=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(e){function t(n){var r=e.call(this,"Tag '"+n+"' does not match any of the known prefixes.")||this;return r.tagRawText=n,Object.setPrototypeOf(r,t.prototype),r}return g(t,e),t}(Error),v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(e){function t(n){var r=e.call(this,"Tag '"+n+"' is closed but was never opened.")||this;return r.tagName=n,Object.setPrototypeOf(r,t.prototype),r}return v(t,e),t}(Error),T=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(e){function t(n){var r=e.call(this,'Filetype "'+n+'" is not supported.')||this;return Object.setPrototypeOf(r,t.prototype),r}return T(t,e),t}(Error);function b(e){if(e.length)return e[e.length-1]}!function(e){(o||(o={})).toJsZipOutputType=function(e){if(!e)throw new c("binary");var t=e.constructor.name.toLowerCase();switch(t){case"blob":case"arraybuffer":return t;case"buffer":return"nodebuffer";default:throw new Error("Binary type '"+t+"' is not supported.")}}}();var O,P=n(0);!function(e){e.Text="Text",e.General="General"}(O||(O={}));var E;!function(e){function t(t){return{nodeType:O.Text,nodeName:e.TEXT_NODE_NAME,textContent:t}}function n(e){return{nodeType:O.General,nodeName:e}}function r(e){if(null===e||void 0===e)throw new c("str");if("string"!=typeof e)throw new TypeError("Expected a string, got '"+e.constructor.name+"'.");return e.replace(/[<>&'"]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}return""})}function o(t){if(t.nodeType===O.Text||t.nodeName===e.TEXT_NODE_NAME){if(t.nodeType!==O.Text||t.nodeName!==e.TEXT_NODE_NAME)throw new Error("Invalid text node. Type: '"+t.nodeType+"', Name: '"+t.nodeName+"'.");return!0}return!1}function i(e,t){if(!e)throw new c(nameof(e));if(o(e))throw new Error("Appending children to text nodes is forbidden");if(!t)throw new c(nameof(t));(e.childNodes||(e.childNodes=[]),e.childNodes.length)&&(e.childNodes[e.childNodes.length-1].nextSibling=t);t.nextSibling=null,t.parentNode=e,e.childNodes.push(t)}function a(e,t){if(!e)throw new c(nameof(e));if(null===t||void 0===t)throw new c(nameof(t));if(!e.childNodes||!e.childNodes.length)throw new Error("Parent node has node children");var n;if("number"==typeof t)n=t;else if(-1===(n=e.childNodes.indexOf(t)))throw new Error("Specified child node is not a child of the specified parent");if(n>=e.childNodes.length)throw new RangeError("Child index "+n+" is out of range. Parent has only "+e.childNodes.length+" child nodes.");var r=e.childNodes[n];n>0&&(e.childNodes[n-1].nextSibling=r.nextSibling);return r.parentNode=null,r.nextSibling=null,e.childNodes.splice(n,1)[0]}e.TEXT_NODE_NAME="#text",e.createTextNode=t,e.createGeneralNode=n,e.encodeValue=r,e.serialize=function e(t){if(o(t))return r(t.textContent)||"";var n="";t.attributes&&t.attributes.length&&(n=" "+t.attributes.map(function(e){return e.name+'="'+e.value+'"'}).join(" "));var i,a=(t.childNodes||[]).length>0,s=a?"":"/",u="<"+t.nodeName+n+s+">";i=a?u+t.childNodes.map(function(t){return e(t)}).join("")+"</"+t.nodeName+">":u;return i},e.fromDomNode=function e(r){var o;if(r.nodeType===r.TEXT_NODE)o=t(r.textContent);else if(o=n(r.nodeName),r.nodeType===r.ELEMENT_NODE){var i=r.attributes;if(i){o.attributes=[];for(var a=0;a<i.length;a++){var s=i.item(a);o.attributes.push({name:s.name,value:s.value})}}}if(r.childNodes){o.childNodes=[];var u=void 0;for(a=0;a<r.childNodes.length;a++){var c=e(r.childNodes.item(a));o.childNodes.push(c),c.parentNode=o,u&&(u.nextSibling=c),u=c}}return o},e.isTextNode=o,e.cloneNode=function(e,t){if(!e)throw new c(nameof(e));var n;return t?((n=function e(t){var n={};if(n.nodeType=t.nodeType,n.nodeName=t.nodeName,o(t))n.textContent=t.textContent;else{var r=t.attributes;r&&(n.attributes=r.map(function(e){return{name:e.name,value:e.value}}))}if(t.childNodes){n.childNodes=[];for(var i=void 0,a=0,s=t.childNodes;a<s.length;a++){var u=s[a],c=e(u);n.childNodes.push(c),c.parentNode=n,i&&(i.nextSibling=c),i=c}}return n}(e)).parentNode=null,n):((n=Object.assign({},e)).parentNode=null,n.childNodes=e.childNodes?[]:null,n.nextSibling=null,n)},e.insertBefore=function(t,n){if(!t)throw new c(nameof(t));if(!n)throw new c(nameof(n));if(!n.parentNode)throw new Error("'"+nameof(n)+"' has no parent");var r=n.parentNode.childNodes.indexOf(n);e.insertChild(n.parentNode,t,r)},e.insertAfter=function(t,n){if(!t)throw new c(nameof(t));if(!n)throw new c(nameof(n));if(!n.parentNode)throw new Error("'"+nameof(n)+"' has no parent");var r=n.parentNode.childNodes.indexOf(n);e.insertChild(n.parentNode,t,r+1)},e.insertChild=function(t,n,r){if(!t)throw new c(nameof(t));if(o(t))throw new Error("Appending children to text nodes is forbidden");if(!n)throw new c(nameof(n));if(t.childNodes||(t.childNodes=[]),r!==t.childNodes.length){if(r>t.childNodes.length)throw new RangeError("Child index "+r+" is out of range. Parent has only "+t.childNodes.length+" child nodes.");n.parentNode=t;var i=t.childNodes[r];n.nextSibling=i,r>0&&(t.childNodes[r-1].nextSibling=n),t.childNodes.splice(r,0,n)}else e.appendChild(t,n)},e.appendChild=i,e.remove=function(e){if(!e)throw new c(nameof(e));if(!e.parentNode)throw new Error("Node has no parent");a(e.parentNode,e)},e.removeChild=a,e.lastTextChild=function(t){if(o(t))return t;if(t.childNodes){var n=t.childNodes.filter(function(e){return o(e)});if(n.length){var r=b(n);return r.textContent||(r.textContent=""),r}}var a={nodeType:O.Text,nodeName:e.TEXT_NODE_NAME,textContent:""};return i(t,a),a},e.removeSiblings=function(t,n){if(t===n)return[];var r,o=[];for(t=t.nextSibling;t!==n;){var i=t;t=t.nextSibling,e.remove(i),o.push(i),r&&(r.nextSibling=i),r=i}return o},e.splitByChild=function(t,n,r){for(var o=function(e,t){for(var n=[],r=t;r!==e;){var o=r.parentNode;if(!o)throw new Error("Argument "+nameof(t)+" is not a descendant of "+nameof(e));var i=o.childNodes.indexOf(r);n.push(i),r=o}return n.reverse()}(t,n),i=e.cloneNode(t,!1),a=o[0]+1;a<t.childNodes.length;){var s=t.childNodes[a];e.remove(s),e.appendChild(i,s)}return t.parentNode&&e.insertAfter(i,t),r&&t.childNodes.length&&e.removeChild(t,t.childNodes.length-1),[t,i]}}(E||(E={}));var D,C=function(){function e(){this.maxXmlDepth=20,this.startDelimiter="{",this.endDelimiter="}"}return e.prototype.findDelimiters=function(e){var t=[];return this.findRecurse(e,t,0),t},e.prototype.findRecurse=function(e,t,n){if(n>this.maxXmlDepth)throw new s(this.maxXmlDepth);if(e)if(E.isTextNode(e)){var r=this.findInNode(e);r.length&&(o=t,i=r,Array.prototype.push.apply(o,i))}else for(var o,i,a=e.childNodes?e.childNodes.length:0,u=0;u<a;u++){var c=e.childNodes[u];this.findRecurse(c,t,n+1)}},e.prototype.findInNode=function(e){if(!e.textContent)return[];for(var t=[],n=0;n<e.textContent.length;n++)e.textContent[n]===this.startDelimiter?t.push({index:n,isOpen:!0,xmlTextNode:e}):e.textContent[n]===this.endDelimiter&&t.push({index:n,isOpen:!1,xmlTextNode:e});return t},e}(),j=n(4),S=function(){function e(e){this.path=[],this.allData=e}return e.prototype.getScopeData=function(){for(var e,t=b(this.path),n=this.path.slice();void 0===e&&n.length;){var r=n.slice(0,n.length-1);e=j(this.allData,r.concat(t)),n=r}return e},e}();!function(e){e.Open="Open",e.Close="Close",e.SelfClosed="SelfClosed"}(D||(D={}));var A=function(){return function(e){Object.assign(this,e)}}(),R=function(){function e(e,t){if(this.tagPrefixes=e,this.docParser=t,this.startDelimiter="{",this.endDelimiter="}",!e||!e.length)throw new c("tagPrefixes");if(!t)throw new c("docParser")}return e.prototype.parse=function(e){for(var t,n,r,o,i=[],a=0,s=e;a<s.length;a++){var u=s[a];if(!t&&!u.isOpen)throw new d("Unknown");if(t&&u.isOpen)throw new p("Unknown");!t&&u.isOpen&&(t=new A,n=u),t&&!u.isOpen&&(r===n.xmlTextNode&&(n.index-=o),r===u.xmlTextNode&&(u.index-=o),r=u.xmlTextNode,o=this.normalizeTagNodes(n,u),t.xmlTextNode=n.xmlTextNode,this.processTag(t),i.push(t),t=null,n=null)}return i},e.prototype.normalizeTagNodes=function(e,t){var n=0,r=e.xmlTextNode,o=t.xmlTextNode,i=r===o;return e.index>0&&(n+=e.index,this.docParser.splitTextNode(r,e.index,!0)),t.index<o.textContent.length-1&&(n+=t.index+1,o=this.docParser.splitTextNode(o,t.index+1,!0),i&&(r=o)),i||(this.docParser.joinTextNodesRange(r,o),o=r),e.xmlTextNode=r,t.xmlTextNode=o,n},e.prototype.processTag=function(e){e.rawText=e.xmlTextNode.textContent;for(var t=0,n=this.tagPrefixes;t<n.length;t++){var r=n[t],o="^["+this.startDelimiter+"](\\s*?)"+r.prefix+"(.*?)["+this.endDelimiter+"]",i=new RegExp(o,"gmi").exec(e.rawText);if(i&&i.length){e.name=i[2],e.type=r.tagType,e.disposition=r.tagDisposition;break}}if(!e.name)throw new N(e.rawText)},e}(),X=function(){function e(e,t,n){this.delimiterSearcher=e,this.tagParser=t,this.plugins=n}return e.prototype.compile=function(e,t,n){var r=this.delimiterSearcher.findDelimiters(e),o=this.tagParser.parse(r);this.doTagReplacements(o,t,n)},e.prototype.doTagReplacements=function(e,t,n){for(var r,o=function(o){var a=e[o];if(t.path.push(a.name),a.disposition===D.SelfClosed)for(var s=0,u=i.plugins;s<u.length;s++){if((d=u[s]).prefixes.some(function(e){return e.tagType===a.type})){d.simpleTagReplacements(a,t,n);break}}else if(a.disposition===D.Open){var c=i.findCloseTagIndex(o,a,e),l=e.slice(o,c+1);o=c;for(var p=0,f=i.plugins;p<f.length;p++){var d;if((d=f[p]).prefixes.some(function(e){return e.tagType===a.type})){d.containerTagReplacements(l,t,n);break}}}t.path.pop(),r=o},i=this,a=0;a<e.length;a++)o(a),a=r},e.prototype.findCloseTagIndex=function(e,t,n){for(var r=e;r<n.length;r++){var o=n[r];if(o.name===t.name&&o.type===t.type&&o.disposition===D.Close)break}if(r===n.length)throw new m(t.name);return r},e}(),k=function(){function e(){}return e.prototype.setUtilities=function(e){this.utilities=e},e.prototype.simpleTagReplacements=function(e,t,n){},e.prototype.containerTagReplacements=function(e,t,n){},e}(),M=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefixes=[{prefix:"#",tagType:"loop",tagDisposition:D.Open},{prefix:"/",tagType:"loop",tagDisposition:D.Close}],t}return M(t,e),t.prototype.containerTagReplacements=function(e,t,n){var r=t.getScopeData();r&&Array.isArray(r)&&r.length||(r=[]);var o,i=e[0],a=b(e),s=this.utilities.docxParser.containingParagraphNode(i.xmlTextNode),u=this.utilities.docxParser.containingParagraphNode(a.xmlTextNode),c=s===u,l=this.splitParagraphs(i.xmlTextNode,a.xmlTextNode);s=l.firstParagraph,u=l.lastParagraph,o=l.middleParagraphs;var p=this.repeat(o,r.length),f=this.compile(p,t,n);this.mergeBack(f,s,u,c)},t.prototype.splitParagraphs=function(e,t){var n=this.utilities.docxParser.containingParagraphNode(e),r=this.utilities.docxParser.containingParagraphNode(t),o=n===r,i=n.parentNode,a=i.childNodes.indexOf(n),s=o?a:i.childNodes.indexOf(r),u=E.splitByChild(n,e,!0);n=u[0];var c=u[1];o&&(r=c);var l,p=(u=E.splitByChild(r,t,!0))[0];if(r=u[1],E.removeChild(i,a+1),o||E.removeChild(i,s),c.parentNode=null,p.parentNode=null,o)this.utilities.docxParser.joinParagraphs(c,p),l=[c];else{var f=E.removeSiblings(n,r);l=[c].concat(f).concat(p)}return{firstParagraph:n,middleParagraphs:l,lastParagraph:r}},t.prototype.repeat=function(e,t){if(!e.length||!t)return[];for(var n=[],r=0;r<t;r++){var o=e.map(function(e){return E.cloneNode(e,!0)});n.push(o)}return n},t.prototype.compile=function(e,t,n){for(var r=[],o=function(o){var a=e[o],s=E.createGeneralNode("dummyRootNode");a.forEach(function(e){return E.appendChild(s,e)}),t.path.push(o),i.utilities.compiler.compile(s,t,n),t.path.pop();for(var u=[];s.childNodes&&s.childNodes.length;){var c=E.removeChild(s,0);u.push(c)}r.push(u)},i=this,a=0;a<e.length;a++)o(a);return r},t.prototype.mergeBack=function(e,t,n,r){for(var o=t,i=0,a=e;i<a.length;i++){var s=a[i];this.utilities.docxParser.joinParagraphs(o,s[0]);for(var u=1;u<s.length;u++)E.insertBefore(s[u],n),o=s[u]}this.utilities.docxParser.joinParagraphs(o,n),E.remove(n)},t}(k),F=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefixes=[{prefix:"@",tagType:"rawXml",tagDisposition:D.SelfClosed}],t}return F(t,e),t.prototype.simpleTagReplacements=function(e,t){var n=this.utilities.docxParser.containingTextNode(e.xmlTextNode),r=t.getScopeData();if("string"==typeof r){var o=this.utilities.xmlParser.parse(r);E.insertBefore(o,n)}E.remove(n)},t}(k),B=function(){function e(){}return e.prototype.contentFilePaths=function(e){return e.file(/word\/(header|footer)\d+\.xml/).map(function(e){return e.name}).concat(["word/document.xml","word/document2.xml"])},e.prototype.mainFilePath=function(e){return e.files["word/document.xml"]?"word/document.xml":e.files["word/document2.xml"]?"word/document2.xml":void 0},e.prototype.splitTextNode=function(e,t,n){var r,o,i=this.containingTextNode(e),a=E.cloneNode(i,!0);if(n)E.insertBefore(a,i),r=E.lastTextChild(a),o=e;else{var s=i.parentNode.childNodes.indexOf(i);E.insertChild(i.parentNode,a,s+1),r=e,o=E.lastTextChild(a)}var u=r.textContent,c=o.textContent;return r.textContent=u.substring(0,t),o.textContent=c.substring(t),n?r:o},e.prototype.joinTextNodesRange=function(t,n){var r=this.containingRunNode(t),o=this.containingRunNode(n),i=r.parentNode;if(o.parentNode!==i)throw new Error("Can not join text nodes from separate paragraphs.");for(var a=this.containingTextNode(t),s=this.containingTextNode(n),u=[],c=r;c;){var l=void 0;for(l=c===r?a:this.firstTextNodeChild(c);l;)if(l.nodeName===e.TEXT_NODE){var p=E.lastTextChild(l);u.push(p.textContent);var f=l;l=l===s?null:l.nextSibling,f!==a&&E.remove(f)}var d=c;c=c===o?null:c.nextSibling,d.childNodes&&d.childNodes.length||E.remove(d)}E.lastTextChild(a).textContent=u.join("")},e.prototype.joinParagraphs=function(t,n){if(t!==n)for(var r=0;n.childNodes&&r<n.childNodes.length;){var o=n.childNodes[r];o.nodeName===e.RUN_NODE?(E.removeChild(n,r),E.appendChild(t,o)):r++}},e.prototype.firstTextNodeChild=function(t){if(!t)return null;if(t.nodeName!==e.RUN_NODE)return null;if(!t.childNodes)return null;for(var n=0,r=t.childNodes;n<r.length;n++){var o=r[n];if(o.nodeName===e.TEXT_NODE)return o}return null},e.prototype.containingTextNode=function(t){if(!t)return null;if(!E.isTextNode(t))throw new Error("'Invalid argument node. Expected a XmlTextNode.");for(var n=t;n.parentNode;){if(n.nodeName===e.TEXT_NODE)return n;n=n.parentNode}return null},e.prototype.containingRunNode=function(t){return t?t.nodeName===e.RUN_NODE?t:this.containingRunNode(t.parentNode):null},e.prototype.containingParagraphNode=function(t){return t?t.nodeName===e.PARAGRAPH_NODE?t:this.containingParagraphNode(t.parentNode):null},e.PARAGRAPH_NODE="w:p",e.RUN_NODE="w:r",e.TEXT_NODE="w:t",e}(),G=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefixes=[{prefix:"",tagType:"text",tagDisposition:D.SelfClosed}],t}return G(t,e),t.prototype.simpleTagReplacements=function(e,t){var n=(t.getScopeData()||"").split("\n");n.length<2?this.replaceSingleLine(e.xmlTextNode,n.length?n[0]:""):this.replaceMultiLine(e.xmlTextNode,n)},t.prototype.replaceSingleLine=function(e,t){e.textContent=t},t.prototype.replaceMultiLine=function(e,t){var n=this.utilities.docxParser.containingRunNode(e);e.textContent=t[0];for(var r=1;r<t.length;r++){var o=this.getLineBreak();E.appendChild(n,o);var i=this.createWordTextNode(t[r]);E.appendChild(n,i)}},t.prototype.getLineBreak=function(){return{nodeType:O.General,nodeName:"w:br"}},t.prototype.createWordTextNode=function(e){var t=E.createGeneralNode(B.TEXT_NODE);return t.childNodes=[E.createTextNode(e)],t},t}(k);function H(){return[new L,new U,new z]}var I,q,V=function(){return function(e){if(this.start="{",this.end="}",e&&(e.start&&(this.start=E.encodeValue(e.start)),e.end&&(this.end=E.encodeValue(e.end))),!this.start||!this.end)throw new Error("Both delimiters must be specified.");if(this.start===this.end)throw new Error("Start and end delimiters can not be the same.");if(this.start.length>1||this.end.length>1)throw new Error("Only single character delimiters supported (start: '"+this.start+"', end: '"+this.end+"').")}}(),J=n(1);(q=I||(I={})).Docx="docx",q.Pptx="pptx",q.Odt="odt",function(e){function t(e){return!(!e.files["word/document.xml"]&&!e.files["word/document2.xml"])}function n(e){return!!e.files["ppt/presentation.xml"]}function r(e){return!!e.files.mimetype}e.getFileType=function(o){if(t(o))return e.Docx;if(n(o))return e.Pptx;if(r(o))return e.Odt;throw new y},e.isDocx=t,e.isPptx=n,e.isOdt=r}(I||(I={}));var W=function(){return function(e){if(this.plugins=H(),this.delimiters=new V,this.maxXmlDepth=20,Object.assign(this,e),e&&(this.delimiters=new V(e.delimiters)),!this.plugins.length)throw new Error("Plugins list can not be empty")}}(),Z=(P.a.isNode?n(3):window).DOMParser,K=function(){function e(){}return e.prototype.parse=function(e){var t=this.domParse(e);return E.fromDomNode(t.documentElement)},e.prototype.domParse=function(t){if(null===t||void 0===t)throw new c("str");return e.parser.parseFromString(t,"text/xml")},e.prototype.serialize=function(t){return e.xmlHeader+E.serialize(t)},e.xmlHeader='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',e.parser=new Z,e}(),Q=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},Y=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},$=function(){function e(e){var t=this;this.docxParser=new B,this.xmlParser=new K,this.options=new W(e);var n=new C;n.startDelimiter=this.options.delimiters.start,n.endDelimiter=this.options.delimiters.end,n.maxXmlDepth=this.options.maxXmlDepth;var r=this.options.plugins.map(function(e){return e.prefixes}).reduce(function(e,t){return e.concat(t)},[]),o=new R(r,this.docxParser);o.startDelimiter=this.options.delimiters.start,o.endDelimiter=this.options.delimiters.end,this.compiler=new X(n,o,this.options.plugins),this.options.plugins.forEach(function(e){e.setUtilities({xmlParser:t.xmlParser,docxParser:t.docxParser,compiler:t.compiler})})}return e.prototype.process=function(e,t){return Q(this,void 0,void 0,function(){var n,r,i,a,s,u,c,l,p,f,d,h;return Y(this,function(m){switch(m.label){case 0:return[4,this.loadDocx(e)];case 1:return n=m.sent(),[4,this.parseContentDocuments(n)];case 2:for(r=m.sent(),i=new S(t),a={zipFile:n,currentFilePath:null},s=0,u=Object.keys(r);s<u.length;s++)p=u[s],a.currentFilePath=p,this.compiler.compile(r[p],i,a);for(c=0,l=Object.keys(r);c<l.length;c++)p=l[c],f=r[p],d=this.xmlParser.serialize(f),n.file(p,d,{createFolders:!0});return h=o.toJsZipOutputType(e),[2,n.generateAsync({type:h})]}})})},e.prototype.getText=function(e){return Q(this,void 0,void 0,function(){var t,n,r;return Y(this,function(o){switch(o.label){case 0:return[4,this.loadDocx(e)];case 1:return t=o.sent(),n=this.docxParser.mainFilePath(t),[4,t.files[n].async("text")];case 2:return r=o.sent(),[2,this.xmlParser.domParse(r).documentElement.textContent]}})})},e.prototype.loadDocx=function(e){return Q(this,void 0,void 0,function(){var t,n;return Y(this,function(r){switch(r.label){case 0:return[4,J.loadAsync(e)];case 1:if(t=r.sent(),(n=I.getFileType(t))!==I.Docx)throw new _(n);return[2,t]}})})},e.prototype.parseContentDocuments=function(e){return Q(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return Y(this,function(u){switch(u.label){case 0:t=this.docxParser.contentFilePaths(e),n=t.filter(function(t){return e.files[t]}),r={},o=0,i=n,u.label=1;case 1:return o<i.length?(a=i[o],[4,e.files[a].async("text")]):[3,4];case 2:s=u.sent(),r[a]=this.xmlParser.parse(s),u.label=3;case 3:return o++,[3,1];case 4:return[2,r]}})})},e}();n.d(t,"DelimiterMark",function(){return i}),n.d(t,"DelimiterSearcher",function(){return C}),n.d(t,"ScopeData",function(){return S}),n.d(t,"TagDisposition",function(){return D}),n.d(t,"Tag",function(){return A}),n.d(t,"TagParser",function(){return R}),n.d(t,"TemplateCompiler",function(){return X}),n.d(t,"MaxXmlDepthError",function(){return s}),n.d(t,"MissingArgumentError",function(){return c}),n.d(t,"MissingCloseDelimiterError",function(){return p}),n.d(t,"MissingStartDelimiterError",function(){return d}),n.d(t,"UnclosedTagError",function(){return m}),n.d(t,"UnidentifiedFileTypeError",function(){return y}),n.d(t,"UnknownPrefixError",function(){return N}),n.d(t,"UnopenedTagError",function(){return w}),n.d(t,"UnsupportedFileTypeError",function(){return _}),n.d(t,"createDefaultPlugins",function(){return H}),n.d(t,"LoopPlugin",function(){return L}),n.d(t,"RawXmlPlugin",function(){return U}),n.d(t,"TemplatePlugin",function(){return k}),n.d(t,"TextPlugin",function(){return z}),n.d(t,"Delimiters",function(){return V}),n.d(t,"DocxParser",function(){return B}),n.d(t,"TemplateHandler",function(){return $}),n.d(t,"TemplateHandlerOptions",function(){return W}),n.d(t,"Binary",function(){return o}),n.d(t,"XmlNodeType",function(){return O}),n.d(t,"TEXT_NODE_NAME_VALUE",function(){return"#text"}),n.d(t,"XmlNode",function(){return E}),n.d(t,"XmlParser",function(){return K})},function(e,t){e.exports=require("xmldom")},function(e,t){e.exports=require("lodash.get")},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,p=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):p=-1,c.length&&d())}function d(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++p<t;)u&&u[p].run();p=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){e.exports=n(2)}])});